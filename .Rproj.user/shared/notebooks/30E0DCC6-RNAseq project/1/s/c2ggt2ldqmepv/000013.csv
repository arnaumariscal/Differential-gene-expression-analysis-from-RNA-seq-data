"0",""
"0","#PCA"
"0","pca <- prcomp(t(log_comptatges_norm), scale. = TRUE)  # log_comptatges_norm needs to be transposed, since columns must represent samples"
"0",""
"0","loads <- round((pca$sdev^2 / sum(pca$sdev^2)) * 100, 1) # percentage of variance explained"
"0",""
"0","# Create a dataframe that combines sample coordinates with metadata"
"0","pc_df <- as.data.frame(pca$x)"
"0","pc_df$mostra_id <- colnames(log_comptatges_norm)"
"0","info_metadades <- as.data.frame(colData(my_se)) "
"0","pc_df <- cbind(pc_df, info_metadades)"
"0",""
"0","# PCA x cohort"
"0","pca_cohort<- ggplot(pc_df, aes(x = PC1, y = PC2, color = cohort)) +"
"0","  geom_point(size = 2) +"
"0","  labs(title = ""Figure A4 (A). PCA x cohort"","
"0","       x = paste0(""PC1 ("", loads[1], ""%)""),"
"0","       y = paste0(""PC2 ("", loads[2], ""%)"")) +"
"0","  theme_minimal() +"
"0","  theme(plot.title = element_text(size = 16, face = ""bold""))"
"0",""
"0","# PCA x batch"
"0","pca_batch<- ggplot(pc_df, aes(x = PC1, y = PC2, color = batch)) +"
"0","  geom_point(size = 2) +"
"0","  labs(title = ""Figure A4 (B). PCA x batch"") +"
"0","  theme_minimal() +"
"0","  theme(plot.title = element_text(size = 16, face = ""bold""))"
"0",""
"0","# PCA x sexe"
"0","pca_sex<- ggplot(pc_df, aes(x = PC1, y = PC2, color = gender)) +"
"0","  geom_point(size = 2) +"
"0","  labs(title = ""Figure A4 (C). PCA x sex"")  +"
"0","  theme_minimal() +"
"0","  theme(plot.title = element_text(size = 16, face = ""bold""))"
"0",""
"0","# PCA x race"
"0","pca_race<- ggplot(pc_df, aes(x = PC1, y = PC2, color = race)) +"
"0","  geom_point(size = 2) +"
"0","  labs(title = ""Figure A4 (D). PCA x race"")  +"
"0","  theme_minimal() +"
"0","  theme(plot.title = element_text(size = 16, face = ""bold""))"
"0",""
"0","# PCA x edat"
"0","pca_age<- ggplot(pc_df, aes(x = PC1, y = PC2, color = age)) +"
"0","  geom_point(size = 2) +"
"0","  scale_color_gradient(low = ""blue"", high = ""red"") +"
"0","  labs(title = ""Figure A4 (E). PCA x age"")  +"
"0","  theme_minimal() +"
"0","  theme(plot.title = element_text(size = 16, face = ""bold""))"
"0",""
